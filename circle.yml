machine:
  services:
    - docker

dependencies:
  override:
    - docker info

compile:
  override:
    - docker build --rm=false -t jlospinoso/abrade:latest .
    - docker cp $(docker create jlospinoso/abrade:latest):/abrade/build/abrade - > $CIRCLE_ARTIFACTS/abrade.tar

test:
  override:
    - docker run jlospinoso/abrade --entrypoint ./abrade_test
